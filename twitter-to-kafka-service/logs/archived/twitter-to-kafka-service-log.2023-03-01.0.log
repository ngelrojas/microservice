2023-03-01 09:31:23 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Starting TwitterToKafkaServiceApplication using Java 17.0.6 with PID 17341 (/home/ngel/Projects/java_lab/springboot_lab/microservice/twitter-to-kafka-servcie/target/classes started by ngel in /home/ngel/Projects/java_lab/springboot_lab/microservice)
2023-03-01 09:31:23 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - No active profile set, falling back to 1 default profile: "default"
2023-03-01 09:31:24 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Started TwitterToKafkaServiceApplication in 0.799 seconds (process running for 1.376)
2023-03-01 09:31:24 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - App started
2023-03-01 09:31:24 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - [Java, MircoServices, Spring, kafka, ElasticSearch]
2023-03-01 09:31:24 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Welcome! this is my test
2023-03-01 09:31:24 [Twitter Stream consumer /  [1][initializing]] INFO  twitter4j.TwitterStreamImpl - Establishing connection.
2023-03-01 09:31:24 [main] INFO  c.m.t.t.k.s.r.i.TwitterKafkaStreamRunner - started filtering twitter stream for keywords [Java, MircoServices, Spring, kafka, ElasticSearch] 
2023-03-01 09:31:24 [Twitter Stream consumer /  [1][Establishing connection]] INFO  twitter4j.TwitterStreamImpl - 403:The request is understood, but it has been refused. An accompanying error message will explain why. This code is used when requests are being denied due to update limits (https://support.twitter.com/articles/15364-about-twitter-limits-update-api-dm-and-following).
message - You currently have Essential access which includes access to Twitter API v2 endpoints only. If you need access to this endpoint, you’ll need to apply for Elevated access via the Developer Portal. You can learn more here: https://developer.twitter.com/en/docs/twitter-api/getting-started/about-twitter-api#v2-access-leve
code - 453

2023-03-01 09:31:24 [Twitter Stream consumer /  [1][Establishing connection]] WARN  twitter4j.TwitterStreamImpl - This account is not in required role. 403:The request is understood, but it has been refused. An accompanying error message will explain why. This code is used when requests are being denied due to update limits (https://support.twitter.com/articles/15364-about-twitter-limits-update-api-dm-and-following).
message - You currently have Essential access which includes access to Twitter API v2 endpoints only. If you need access to this endpoint, you’ll need to apply for Elevated access via the Developer Portal. You can learn more here: https://developer.twitter.com/en/docs/twitter-api/getting-started/about-twitter-api#v2-access-leve
code - 453

2023-03-01 09:31:24 [SpringApplicationShutdownHook] INFO  c.m.t.t.k.s.r.i.TwitterKafkaStreamRunner - closing twitter stream
2023-03-01 09:44:05 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Starting TwitterToKafkaServiceApplication using Java 17.0.6 with PID 18578 (/home/ngel/Projects/java_lab/springboot_lab/microservice/twitter-to-kafka-servcie/target/classes started by ngel in /home/ngel/Projects/java_lab/springboot_lab/microservice)
2023-03-01 09:44:05 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - No active profile set, falling back to 1 default profile: "default"
2023-03-01 09:44:05 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Started TwitterToKafkaServiceApplication in 0.84 seconds (process running for 1.409)
2023-03-01 09:44:05 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - App started
2023-03-01 09:44:05 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - [Java, MircoServices, Spring, kafka, ElasticSearch]
2023-03-01 09:44:05 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Welcome! this is my test
2023-03-01 09:44:05 [Twitter Stream consumer /  [1][initializing]] INFO  twitter4j.TwitterStreamImpl - Establishing connection.
2023-03-01 09:44:05 [main] INFO  c.m.t.t.k.s.r.i.TwitterKafkaStreamRunner - started filtering twitter stream for keywords [Java, MircoServices, Spring, kafka, ElasticSearch] 
2023-03-01 09:44:06 [Twitter Stream consumer /  [1][Establishing connection]] INFO  twitter4j.TwitterStreamImpl - 403:The request is understood, but it has been refused. An accompanying error message will explain why. This code is used when requests are being denied due to update limits (https://support.twitter.com/articles/15364-about-twitter-limits-update-api-dm-and-following).
message - You currently have Essential access which includes access to Twitter API v2 endpoints only. If you need access to this endpoint, you’ll need to apply for Elevated access via the Developer Portal. You can learn more here: https://developer.twitter.com/en/docs/twitter-api/getting-started/about-twitter-api#v2-access-leve
code - 453

2023-03-01 09:44:06 [Twitter Stream consumer /  [1][Establishing connection]] WARN  twitter4j.TwitterStreamImpl - This account is not in required role. 403:The request is understood, but it has been refused. An accompanying error message will explain why. This code is used when requests are being denied due to update limits (https://support.twitter.com/articles/15364-about-twitter-limits-update-api-dm-and-following).
message - You currently have Essential access which includes access to Twitter API v2 endpoints only. If you need access to this endpoint, you’ll need to apply for Elevated access via the Developer Portal. You can learn more here: https://developer.twitter.com/en/docs/twitter-api/getting-started/about-twitter-api#v2-access-leve
code - 453

2023-03-01 09:44:06 [SpringApplicationShutdownHook] INFO  c.m.t.t.k.s.r.i.TwitterKafkaStreamRunner - closing twitter stream
2023-03-01 10:16:54 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Starting TwitterToKafkaServiceApplication using Java 17.0.6 with PID 25184 (/home/ngel/Projects/java_lab/springboot_lab/microservice/twitter-to-kafka-servcie/target/classes started by ngel in /home/ngel/Projects/java_lab/springboot_lab/microservice)
2023-03-01 10:16:54 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - No active profile set, falling back to 1 default profile: "default"
2023-03-01 10:16:54 [main] WARN  o.s.c.a.AnnotationConfigApplicationContext - Exception encountered during context initialization - cancelling refresh attempt: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'twitterToKafkaServiceApplication': Unsatisfied dependency expressed through constructor parameter 1: No qualifying bean of type 'com.microservice.twitter.to.kafka.service.runner.StreamRunner' available: expected single matching bean but found 2: twitterKafkaStreamRunner,twitterV2KafkaStreamRunner
2023-03-01 10:16:54 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2023-03-01 10:16:54 [main] ERROR o.s.b.d.LoggingFailureAnalysisReporter - 

***************************
APPLICATION FAILED TO START
***************************

Description:

Parameter 1 of constructor in com.microservice.twitter.to.kafka.service.TwitterToKafkaServiceApplication required a single bean, but 2 were found:
	- twitterKafkaStreamRunner: defined in file [/home/ngel/Projects/java_lab/springboot_lab/microservice/twitter-to-kafka-servcie/target/classes/com/microservice/twitter/to/kafka/service/runner/impl/TwitterKafkaStreamRunner.class]
	- twitterV2KafkaStreamRunner: defined in file [/home/ngel/Projects/java_lab/springboot_lab/microservice/twitter-to-kafka-servcie/target/classes/com/microservice/twitter/to/kafka/service/runner/impl/TwitterV2KafkaStreamRunner.class]


Action:

Consider marking one of the beans as @Primary, updating the consumer to accept multiple beans, or using @Qualifier to identify the bean that should be consumed

2023-03-01 10:22:08 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Starting TwitterToKafkaServiceApplication using Java 17.0.6 with PID 26976 (/home/ngel/Projects/java_lab/springboot_lab/microservice/twitter-to-kafka-servcie/target/classes started by ngel in /home/ngel/Projects/java_lab/springboot_lab/microservice)
2023-03-01 10:22:08 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - No active profile set, falling back to 1 default profile: "default"
2023-03-01 10:22:09 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Started TwitterToKafkaServiceApplication in 0.8 seconds (process running for 1.256)
2023-03-01 10:22:09 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - App started
2023-03-01 10:22:09 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - [Java, MircoServices, Spring, kafka, ElasticSearch]
2023-03-01 10:22:09 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Welcome! this is my test
2023-03-01 10:22:09 [main] INFO  c.m.t.t.k.s.r.i.TwitterV2KafkaStreamRunner - Created filter for twitter stream for keywords: [Java, MircoServices, Spring, kafka, ElasticSearch]
2023-03-01 10:22:09 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2023-03-01 10:22:09 [main] ERROR o.s.boot.SpringApplication - Application run failed
java.lang.IllegalStateException: Failed to execute CommandLineRunner
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:772)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:317)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1304)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1293)
	at com.microservice.twitter.to.kafka.service.TwitterToKafkaServiceApplication.main(TwitterToKafkaServiceApplication.java:29)
Caused by: java.lang.NullPointerException: Cannot invoke "String.length()" because "this.input" is null
	at java.base/java.net.URI$Parser.parse(URI.java:3165)
	at java.base/java.net.URI.<init>(URI.java:623)
	at org.apache.http.client.utils.URIBuilder.<init>(URIBuilder.java:82)
	at com.microservice.twitter.to.kafka.service.runner.impl.TwitterV2StreamHelper.getRules(TwitterV2StreamHelper.java:150)
	at com.microservice.twitter.to.kafka.service.runner.impl.TwitterV2StreamHelper.setupRules(TwitterV2StreamHelper.java:108)
	at com.microservice.twitter.to.kafka.service.runner.impl.TwitterV2KafkaStreamRunner.start(TwitterV2KafkaStreamRunner.java:40)
	at com.microservice.twitter.to.kafka.service.TwitterToKafkaServiceApplication.run(TwitterToKafkaServiceApplication.java:37)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:769)
	... 5 common frames omitted
2023-03-01 10:25:55 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Starting TwitterToKafkaServiceApplication using Java 17.0.6 with PID 28309 (/home/ngel/Projects/java_lab/springboot_lab/microservice/twitter-to-kafka-servcie/target/classes started by ngel in /home/ngel/Projects/java_lab/springboot_lab/microservice)
2023-03-01 10:25:55 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - No active profile set, falling back to 1 default profile: "default"
2023-03-01 10:25:55 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Started TwitterToKafkaServiceApplication in 0.929 seconds (process running for 1.524)
2023-03-01 10:25:55 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - App started
2023-03-01 10:25:55 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - [Java, MircoServices, Spring, kafka, ElasticSearch]
2023-03-01 10:25:55 [main] INFO  c.m.t.t.k.s.TwitterToKafkaServiceApplication - Welcome! this is my test
2023-03-01 10:25:55 [main] INFO  c.m.t.t.k.s.r.i.TwitterV2KafkaStreamRunner - Created filter for twitter stream for keywords: [Java, MircoServices, Spring, kafka, ElasticSearch]
2023-03-01 10:25:55 [main] INFO  o.s.b.a.l.ConditionEvaluationReportLogger - 

Error starting ApplicationContext. To display the condition evaluation report re-run your application with 'debug' enabled.
2023-03-01 10:25:55 [main] ERROR o.s.boot.SpringApplication - Application run failed
java.lang.IllegalStateException: Failed to execute CommandLineRunner
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:772)
	at org.springframework.boot.SpringApplication.callRunners(SpringApplication.java:753)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:317)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1304)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1293)
	at com.microservice.twitter.to.kafka.service.TwitterToKafkaServiceApplication.main(TwitterToKafkaServiceApplication.java:31)
Caused by: java.lang.NullPointerException: Cannot invoke "String.length()" because "this.input" is null
	at java.base/java.net.URI$Parser.parse(URI.java:3165)
	at java.base/java.net.URI.<init>(URI.java:623)
	at org.apache.http.client.utils.URIBuilder.<init>(URIBuilder.java:82)
	at com.microservice.twitter.to.kafka.service.runner.impl.TwitterV2StreamHelper.getRules(TwitterV2StreamHelper.java:150)
	at com.microservice.twitter.to.kafka.service.runner.impl.TwitterV2StreamHelper.setupRules(TwitterV2StreamHelper.java:108)
	at com.microservice.twitter.to.kafka.service.runner.impl.TwitterV2KafkaStreamRunner.start(TwitterV2KafkaStreamRunner.java:40)
	at com.microservice.twitter.to.kafka.service.TwitterToKafkaServiceApplication.run(TwitterToKafkaServiceApplication.java:39)
	at org.springframework.boot.SpringApplication.callRunner(SpringApplication.java:769)
	... 5 common frames omitted
